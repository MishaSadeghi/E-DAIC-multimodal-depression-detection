### Starting TaskPrologue of job 824183 on tg093 at Fri 24 May 2024 04:07:41 PM CEST
Running on cores 64-95 with governor ondemand
Fri May 24 16:07:41 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.54.15              Driver Version: 550.54.15      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-40GB          On  |   00000000:81:00.0 Off |                    0 |
| N/A   33C    P0             58W /  400W |       0MiB /  40960MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
### Finished TaskPrologue

Using device: cuda
feature_type:  confidence_success_all
Epoch [1/20], Step [1/21], Loss train: 8.6669
Traceback (most recent call last):
  File "/home/hpc/empk/empk004h/depression-detection/code_for_job/visual/LSTM/enhancing_base_code/LSTM_enhance.py", line 316, in <module>
    outputs = model(features).squeeze()
  File "/home/woody/empk/empk004h/software/private/conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/woody/empk/empk004h/software/private/conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hpc/empk/empk004h/depression-detection/code_for_job/visual/LSTM/enhancing_base_code/LSTM_enhance.py", line 217, in forward
    lstm_out, _ = self.lstm(x)
  File "/home/woody/empk/empk004h/software/private/conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/woody/empk/empk004h/software/private/conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/woody/empk/empk004h/software/private/conda/envs/venv/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 878, in forward
    result = _VF.lstm(input, hx, self._flat_weights, self.bias, self.num_layers,
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.79 GiB. GPU 0 has a total capacity of 39.38 GiB of which 20.42 GiB is free. Including non-PyTorch memory, this process has 18.95 GiB memory in use. Of the allocated memory 6.78 GiB is allocated by PyTorch, and 11.65 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
srun: error: tg093: task 0: Exited with exit code 1
srun: Terminating StepId=824183.0
=== JOB_STATISTICS ===
=== current date     : Fri 24 May 2024 04:09:07 PM CEST
= Job-ID             : 824183 on tinygpu
= Job-Name           : job_enhanced_LSTM.sh
= Job-Command        : /home/hpc/empk/empk004h/depression-detection/code_for_job/visual/LSTM/enhancing_base_code/job_enhanced_LSTM.sh
= Initial workdir    : /home/hpc/empk/empk004h/depression-detection/code_for_job/visual/LSTM/enhancing_base_code
= Queue/Partition    : a100
= Slurm account      : empk with QOS=normal
= Requested resources:  for 20:00:00
= Elapsed runtime    : 00:01:27
= Total RAM usage    : 1.2 GiB of requested  GiB (%)   
= Node list          : tg093
= Subm/Elig/Start/End: 2024-05-24T16:01:47 / 2024-05-24T16:01:47 / 2024-05-24T16:07:40 / 2024-05-24T16:09:07
======================
=== Quota infos ======
    Path              Used     SoftQ    HardQ    Gracetime  Filec    FileQ    FiHaQ    FileGrace    
    /home/hpc           51.3G   104.9G   209.7G        N/A  28,927      500K   1,000K        N/A    
    /home/vault        591.1G     0.0K     0.0K        N/A      87K     300K     450K        N/A    
======================
=== GPU utilization ==
gpu_name, gpu_bus_id, pid, gpu_utilization [%], mem_utilization [%], max_memory_usage [MiB], time [ms]
NVIDIA A100-SXM4-40GB, 00000000:81:00.0, 153834, 71 %, 3 %, 39674 MiB, 75337 ms
